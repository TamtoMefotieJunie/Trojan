from flask import session
from model import Malware

class MalwareController:
    def create_malware_record(self):
        """Create a new malware record."""
        malware = Malware.create()
        print(f"Malware created: {malware}")
        return {"status": "success", "malware": malware}
    
    def read_malware_records(self):
        """Read all malware records."""
        malware = Malware.read()
        print(f"Malware records read: {malware}")
        return malware
    
    def read_one(self, instance_id):
        """Read a single malware record by instance ID."""
        malware = Malware.read_one(instance_id)
        if malware:
            print(f"Malware read by ID: {malware}")
            return {"status": "success", "malware": malware}
        else:
            print(f"Malware with ID {instance_id} not found.")
            return {"status": "error", "message": "Malware not found"}
    
    def activate_malware_record(self, instance_id):
        """Activate a malware record."""
        malware = Malware.read_one(instance_id)
        if malware:
            malware.status = 'active'  # Update status directly
            session.commit()  # Commit changes
            print(f"Malware activated: {malware}")
            return {"status": "success", "malware": malware}
        else:
            print(f"Malware with ID {instance_id} not found.")
            return {"status": "error", "message": "Malware not found"}
    
    def enable_malware_record(self, instance_id):
        """Enable a malware record."""
        malware = Malware.read_one(instance_id)
        if malware:
            malware.status = 'enabled'  # Update status directly
            session.commit()  # Commit changes
            print(f"Malware enabled: {malware}")
            return {"status": "success", "malware": malware}
        else:
            print(f"Malware with ID {instance_id} not found.")
            return {"status": "error", "message": "Malware not found"}

    def disable_malware_record(self, instance_id):
        """Disable a malware record."""
        malware = Malware.read_one(instance_id)
        if malware:
            malware.status = 'disabled'  # Update status directly
            session.commit()  # Commit changes
            print(f"Malware disabled: {malware}")
            return {"status": "success", "malware": malware}
        else:
            print(f"Malware with ID {instance_id} not found.")
            return {"status": "error", "message": "Malware not found"}
    
    def delete_malware_record(self, instance_id):
        """Delete a malware record by instance ID."""
        malware = Malware.read_one(instance_id)
        if malware:
            session.delete(malware)  # Delete the malware record
            session.commit()  # Commit changes
            print(f"Malware deleted: {malware}")
            return {"status": "success", "deleted": malware}
        else:
            print(f"Malware with ID {instance_id} not found.")
            return {"status": "error", "message": "Malware not found"}

# Example usage
malware_controller = MalwareController()
malware_controller.read_malware_records()
activation_result = malware_controller.activate_malware_record(instance_id="some_instance_id")
enable_result = malware_controller.enable_malware_record(instance_id="some_instance_id")
disable_result = malware_controller.disable_malware_record(instance_id="some_instance_id")
delete_result = malware_controller.delete_malware_record(instance_id="some_instance_id")